<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dsw.iot.dal.RelatedPhoneConfirmDoMapperExt" >
	<resultMap id="resultMapVo" type="com.dsw.iot.vo.RelatedPhoneConfirmVo" >
	  <!--
	    WARNING - @mbggenerated
	    This element is automatically generated by MyBatis Generator, do not modify.
	    This element was generated on Thu Mar 01 11:47:52 CST 2018.
	  -->
	  <id column="id" property="id" jdbcType="INTEGER" />
	  <result column="register_id" property="registerId" jdbcType="INTEGER" />
	  <result column="police_name" property="policeName" jdbcType="VARCHAR" />
	  <result column="call_name" property="callName" jdbcType="VARCHAR" />
	  <result column="apply_name" property="applyName" jdbcType="VARCHAR" />
	  <result column="apply_reason" property="applyReason" jdbcType="VARCHAR" />
	  <result column="apply_time" property="applyTime" jdbcType="TIMESTAMP" />
	  <result column="talk_time" property="talkTime" jdbcType="VARCHAR" />
	  <result column="tel" property="tel" jdbcType="VARCHAR" />
	  <result column="audit_user" property="auditUser" jdbcType="VARCHAR" />
	  <result column="audit_time" property="auditTime" jdbcType="TIMESTAMP" />
	  <result column="audit_content" property="auditContent" jdbcType="VARCHAR" />
	  <result column="status" property="status" jdbcType="VARCHAR" />
	  <result column="is_deleted" property="isDeleted" jdbcType="VARCHAR" />
	  <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
	  <result column="create_user" property="createUser" jdbcType="VARCHAR" />
	  <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
	  <result column="update_user" property="updateUser" jdbcType="VARCHAR" />
	  <result column="remark" property="remark" jdbcType="VARCHAR" />
	  <result column="record_id" property="recordId" jdbcType="VARCHAR" />
	</resultMap>
	
<sql id="Base_Column_List2" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Mar 01 11:47:52 CST 2018.
    -->
    id, register_id, police_name, call_name, apply_name, apply_reason, apply_time, talk_time, 
    tel, audit_user, audit_time, audit_content, status, is_deleted, create_time, create_user, 
    update_time, update_user, remark, record_id
  </sql>
<select id="selectRelatedPhoneRecordVo" resultMap="resultMapVo" parameterType="com.dsw.iot.model.RelatedPhoneConfirmDoExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Mar 01 11:47:52 CST 2018.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List2" />
    from 
    ( 
    	select distinct t1.*, t2.id as record_id
    	from related_phone_confirm t1
    	left join attach t2
    	on t1.id = t2.task_id
    	and t2.task_belong = 'PHONE_RECORD'
   	)tt
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="oredCriteria.size != 0" >
      and is_deleted = 'N'
    </if>
    <if test="oredCriteria.size == 0" >
      where is_deleted = 'N'
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
    <if test="pageDto != null" >
      limit ${pageDto.offset},${pageDto.pageSize}
    </if>
  </select>
</mapper>